"use strict";(self["webpackChunksave_world_web_tg_app"]=self["webpackChunksave_world_web_tg_app"]||[]).push([[451],{5548:function(s,t,a){a.d(t,{L:function(){return l}});var e=a(5234),o=a(4373),i=a(3957);const l=(0,e.nY)("quests",{state:()=>({categories:[{cat_id:0,title:"Social",tasks:[{id:0,title:"Task 1",url:"https://vk.com/al_feed.php",status:"VERIFYING"},{id:1,title:"Tasks 2",url:"https://vk.com/al_feed.php",status:"CLAIMED"},{id:2,title:"Task 1",url:"https://vk.com/al_feed.php",status:"COMPLETED"},{id:3,title:"Tasks 2",url:"https://vk.com/al_feed.php",status:"NOT_STARTED"},{id:4,title:"Tasks 3",url:"https://vk.com/al_feed.php",status:"NOT_STARTED"}]},{cat_id:1,title:"Social 2",tasks:[{id:5,title:"Task 1",url:"https://vk.com/al_feed.php",status:"VERIFYING"},{id:6,title:"Tasks 2",url:"https://vk.com/al_feed.php",status:"CLAIMED"},{id:7,title:"Task 1",url:"https://vk.com/al_feed.php",status:"COMPLETED"},{id:8,title:"Tasks 2",url:"https://vk.com/al_feed.php",status:"NOT_STARTED"},{id:9,title:"Tasks 3",url:"https://vk.com/al_feed.php",status:"NOT_STARTED"}]}],promoTasks:[{promo_task_id:0,title:"Recycle",description:"Recycle 5 batteries.",promo_task_status:"COMPLETED",tasks:[{id:0,title:"Task 1",url:"https://vk.com/al_feed.php",status:"VERIFYING"},{id:1,title:"Tasks 2",url:"https://vk.com/al_feed.php",status:"CLAIMED"},{id:2,title:"Task 1",url:"https://vk.com/al_feed.php",status:"COMPLETED"},{id:3,title:"Tasks 2",url:"https://vk.com/al_feed.php",status:"NOT_STARTED"},{id:4,title:"Tasks 3",url:"https://vk.com/al_feed.php",status:"NOT_STARTED"}]}]}),actions:{fetchQuests(){return this.promoTasks},acceptTask(s){const t=this.categories.find((t=>t.tasks.some((t=>t.id===s.id))));if(t){const a=t.tasks.find((t=>t.id===s.id));a&&(a.status="VERIFYING",setTimeout((()=>{a.status="COMPLETED"}),5e3))}},acceptPromoTask(s){const t=this.promoTasks.find((t=>t.tasks.some((t=>t.id===s.id))));if(t){const a=t.tasks.find((t=>t.id===s.id));if(a){a.status="VERIFYING",t.promo_task_status="IN_PROGRESS",setTimeout((()=>{a.status="COMPLETED"}),5e3);let s=!0;t.tasks.forEach((t=>{"COMPLETED"===t.status||(s=!1)})),s&&(t.promo_task_status="COMPLETED")}}},claimPromoTaskReward(s){const t=this.promoTasks.find((t=>t.promo_task_id===s.promo_task_id));t&&(s.promo_task_status="CLAIMED")},claimReward(s){const t=this.categories.find((t=>t.tasks.some((t=>t.id===s.id))));if(t){const a=t.tasks.find((t=>t.id===s.id));a&&(a.status="CLAIMED")}},async joinQuest(s){const t=await o.A.post(i.$.backendURL+"/orders/join-quest",{quest:s,withCredentials:!0});if(201!==t.status)throw new Error("Не удалось создать обращение. Неправильный статус ответа от сервера: "+t.status)}},getters:{}})},3477:function(s,t,a){a.d(t,{A:function(){return v}});var e=a(6768),o=a(4232),i=a.p+"img/battery.e2012877.svg",l=a(4462),r=a(5548),k=a(5234);const c={class:"task-item"},u={class:"left-side"},p={class:"info"},d={key:0,class:"loader-wrapper"},n={key:1,class:"claimed-wrapper"};var _=(0,e.pM)({__name:"TaskItem",props:{task:{},isPromoTask:{type:Boolean}},setup(s){const t=(0,r.L)(),a=s,{categories:_}=(0,k.bP)(t),m=(0,e.EW)((()=>{const s=_.value.find((s=>s.tasks.some((s=>s.id===a.task.id)))),t=s?.tasks.find((s=>s.id===a.task.id));return t||a.task})),T=async()=>{try{window.open(m.value.url,"_blank"),t.acceptTask(m.value)}catch(s){return void console.error(s)}},v=async()=>{try{t.claimReward(m.value)}catch(s){return void console.error(s)}};return(s,t)=>((0,e.uX)(),(0,e.CE)("div",c,[(0,e.Lk)("div",u,[t[1]||(t[1]=(0,e.Lk)("img",{src:i,alt:""},null,-1)),(0,e.Lk)("div",p,[(0,e.Lk)("h3",null,(0,o.v_)(m.value.title),1),t[0]||(t[0]=(0,e.Lk)("div",{class:"income"},[(0,e.Lk)("p",null,"+ 699"),(0,e.Lk)("img",{src:l,alt:""})],-1))])]),"VERIFYING"===m.value.status?((0,e.uX)(),(0,e.CE)("div",d,t[2]||(t[2]=[(0,e.Lk)("div",{class:"loader"},null,-1)]))):(0,e.Q3)("",!0),"CLAIMED"===m.value.status?((0,e.uX)(),(0,e.CE)("div",n,t[3]||(t[3]=[(0,e.Lk)("p",null,"Completed",-1)]))):"NOT_STARTED"===m.value.status?((0,e.uX)(),(0,e.CE)("button",{key:2,onClick:T},(0,o.v_)(s.t("accept-task")),1)):"COMPLETED"===m.value.status?((0,e.uX)(),(0,e.CE)("button",{key:3,onClick:v},(0,o.v_)(s.t("claim-task")),1)):(0,e.Q3)("",!0)]))}}),m=a(1241);const T=(0,m.A)(_,[["__scopeId","data-v-75750cfb"]]);var v=T},2237:function(s,t,a){a.r(t),a.d(t,{default:function(){return C}});var e=a(6768),o=a(5179),i=a(1020),l=a(4232),r=a(144),k=a(3477),c=a(5234),u=a(5548);const p={class:"promo-task"},d={class:"container"},n={class:"promo-task-content"},_={class:"task-category__tasks"};var m=(0,e.pM)({__name:"PromoTaskSection",props:{promoTaskID:{}},emits:["clicked"],setup(s,{emit:t}){const a=s,o=(0,u.L)(),{promoTasks:i}=(0,c.bP)(o),m=i.value.find((s=>s.promo_task_id===Number(a.promoTaskID)));return(s,t)=>((0,e.uX)(),(0,e.CE)("section",p,[(0,e.Lk)("div",d,[(0,e.Lk)("div",n,[(0,e.Lk)("h2",null,(0,l.v_)(s.t("promo-tasks")),1),(0,e.Lk)("div",_,[((0,e.uX)(!0),(0,e.CE)(e.FK,null,(0,e.pI)((0,r.R1)(m).tasks,((s,t)=>((0,e.uX)(),(0,e.Wv)(k.A,{class:"task-category__task",key:t,task:s,isPromoTask:!0},null,8,["task"])))),128))])])])]))}}),T=a(1241);const v=(0,T.A)(m,[["__scopeId","data-v-fce734dc"]]);var E=v,f=a(1387),h=(0,e.pM)({__name:"PromoTaskView",setup(s){const t=(0,f.lq)(),a=(0,r.KR)(t.params.promo_task_id);return(0,e.sV)((()=>{console.log(t.params.promo_task_id)})),(s,t)=>((0,e.uX)(),(0,e.CE)(e.FK,null,[(0,e.bF)(o.A),(0,e.Lk)("main",null,[(0,e.bF)(E,{promoTaskID:a.value},null,8,["promoTaskID"])]),(0,e.bF)(i.A)],64))}});const L=h;var C=L},4462:function(s,t,a){s.exports=a.p+"img/green-coin.40870ff4.svg"}}]);
//# sourceMappingURL=451.10ab0aa2.js.map